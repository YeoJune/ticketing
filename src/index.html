<!DOCTYPE html>
<html lang="ko">
<head>
    <title>티켓팅 매니저</title>
    <meta charset="UTF-8">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="app" class="container mx-auto px-4 py-8 max-w-4xl">
        <!-- 진행 상태 표시 -->
        <div class="stepper">
            <div class="step active" id="step1">
                <div class="step-number">1</div>
                <div class="step-label">사이트 선택</div>
            </div>
            <div class="step" id="step2">
                <div class="step-number">2</div>
                <div class="step-label">계정 관리</div>
            </div>
            <div class="step" id="step3">
                <div class="step-number">3</div>
                <div class="step-label">실행 설정</div>
            </div>
        </div>

        <!-- 사이트 선택 섹션 -->
        <div id="siteSelection" class="card">
            <h2 class="text-2xl font-semibold mb-6">티켓팅 사이트 선택</h2>
            <div id="siteList" class="grid gap-4">
                <!-- 사이트 카드들이 여기에 동적으로 추가됨 -->
            </div>
        </div>

        <!-- 계정 관리 섹션 -->
        <div id="accountManagement" class="card" style="display: none;">
            <h2 class="text-2xl font-semibold mb-6">계정 관리</h2>
            
            <!-- 계정 추가/수정 폼 -->
            <form id="accountForm" class="mb-6">
                <input type="hidden" id="editingIndex" value="">
                <div class="input-group">
                    <input type="text" id="username" placeholder="아이디" class="input-field mb-2" required>
                    <input type="password" id="password" placeholder="비밀번호" class="input-field" required>
                    <div class="flex justify-between mt-4">
                        <button type="submit" id="saveAccountBtn" class="btn-primary">계정 추가</button>
                        <button type="button" id="cancelEditBtn" class="btn-secondary" style="display: none;">수정 취소</button>
                    </div>
                </div>
            </form>

            <!-- 계정 목록 헤더 -->
            <div class="flex items-center mb-4">
                <div class="flex-1">
                    <label class="flex items-center">
                        <input type="checkbox" id="selectAllAccounts" class="mr-2">
                        <span class="text-sm font-medium">전체 선택</span>
                    </label>
                </div>
                <button id="deleteSelectedBtn" class="btn-secondary text-sm" style="display: none;">
                    선택 삭제
                </button>
            </div>

            <!-- 계정 목록 -->
            <div id="accountList" class="mt-6">
                <!-- 계정들이 동적으로 추가됨 -->
            </div>

            <!-- 네비게이션 버튼 -->
            <div class="flex justify-between mt-6">
                <button onclick="showSiteSelection()" class="btn-secondary">이전 단계</button>
                <button onclick="startExecution()" class="btn-primary">다음 단계</button>
            </div>
        </div>

        <!-- 실행 모드 섹션 -->
        <div id="executionMode" class="card" style="display: none;">
            <h2 class="text-2xl font-semibold mb-6">실행 설정</h2>
            
            <!-- 로그인 진행 상황 -->
            <div id="loginProgress" class="bg-gray-50 rounded-lg p-4 mb-6" style="display: none;">
                <div class="flex items-center justify-between mb-2">
                    <h3 class="text-sm font-medium text-gray-700">로그인 진행 상황</h3>
                    <span id="progressText" class="text-sm text-gray-600">0 / 0</span>
                </div>
                <div class="bg-gray-200 rounded-full h-2 overflow-hidden mb-2">
                    <div id="progressBar" class="bg-blue-500 h-full transition-all duration-300" style="width: 0%"></div>
                </div>
                <div class="flex flex-wrap gap-2" id="accountStatus">
                    <!-- 계정 상태 뱃지들이 여기에 추가됨 -->
                </div>
                <div id="recentStatus" class="mt-2 text-sm text-gray-600"></div>
            </div>

            <!-- 실행 설정 폼 -->
            <form id="executionForm" class="space-y-6">
                <!-- URL 입력 -->
                <div class="space-y-2">
                    <label class="block text-sm font-medium text-gray-700">티켓팅 URL</label>
                    <input type="text" 
                           id="targetUrl" 
                           class="input-field" 
                           placeholder="URL을 입력하세요"
                           required>
                </div>

                <!-- 날짜/시간 선택 -->
                <div class="grid grid-cols-2 gap-4">
                    <!-- 날짜 선택 -->
                    <div class="space-y-2">
                        <label class="block text-sm font-medium text-gray-700">티켓팅 날짜</label>
                        <div class="flex space-x-2">
                            <input type="text" 
                                   id="targetDateText" 
                                   class="input-field" 
                                   placeholder="YYYY-MM-DD"
                                   pattern="\d{4}-\d{2}-\d{2}"
                                   title="YYYY-MM-DD 형식으로 입력하세요">
                            <input type="date" 
                                   id="targetDate" 
                                   class="input-field w-1/2"
                                   style="display: none;">
                            <button type="button" 
                                    id="toggleDateInput" 
                                    class="btn-secondary px-3"
                                    onclick="toggleDateInputType()">달력</button>
                        </div>
                    </div>

                    <!-- 시간 선택 -->
                    <div class="space-y-2">
                        <label class="block text-sm font-medium text-gray-700">티켓팅 시간</label>
                        <div class="flex items-center space-x-2">
                            <input type="text" 
                                   id="targetTime" 
                                   class="input-field" 
                                   placeholder="HH:MM"
                                   pattern="([01]?[0-9]|2[0-3]):[0-5][0-9]"
                                   title="HH:MM 형식으로 입력하세요 (예: 14:30)">
                        </div>
                        <div class="text-xs text-gray-500">24시간 형식으로 입력 (예: 14:30)</div>
                    </div>
                </div>

                <!-- 실행 예약 시간 -->
                <div class="space-y-2">
                    <label class="block text-sm font-medium text-gray-700">실행 예약 시간</label>
                    <div class="flex space-x-4">
                        <button type="button" class="btn-secondary" onclick="setExecutionTime(-10)">10초 전</button>
                        <button type="button" class="btn-secondary" onclick="setExecutionTime(-30)">30초 전</button>
                        <button type="button" class="btn-secondary" onclick="setExecutionTime(-60)">1분 전</button>
                        <button type="button" class="btn-secondary" onclick="setExecutionTime(-300)">5분 전</button>
                    </div>
                    <div class="flex space-x-2 mt-2">
                        <input type="text" 
                               id="executionDateTime" 
                               class="input-field" 
                               placeholder="YYYY-MM-DD HH:MM:SS">
                        <button type="button" 
                                class="btn-secondary" 
                                onclick="useCurrentTime()">현재</button>
                    </div>
                </div>

                <!-- 현재 시간 표시 -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-3">
                    <div class="text-center text-sm text-blue-800">
                        <span class="font-medium">현재 시간: </span>
                        <span id="currentTime" class="font-mono"></span>
                    </div>
                </div>

                <!-- 버튼 -->
                <div class="flex justify-between pt-4">
                    <button type="button" onclick="returnToAccountManagement()" class="btn-secondary">
                        이전 단계
                    </button>
                    <div class="space-x-2">
                        <button type="submit" class="btn-primary">실행 예약</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <script src="script.js"></script>
</body>
</html>